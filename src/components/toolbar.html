<!Doctype html>  
<html>  
    <head>  
    <meta http-equiv=Content-Type content="text/html;charset=utf-8">  
    <title>工具栏</title>  
    <!-- 如果本文件的包与src不是在同一个目录,就要将basepath设置到src目录下 -->  
    <script type="text/javascript">  
        mxBasePath = '../components/src'; 
    </script>  
  
    <!-- 引入graph需要的文件 -->  
    <script type="text/javascript" src="../components/src/js/mxClient.js"></script>
    <script src="../js/jquery-3.5.1.min.js"></script>
    <!-- 导出/入 转换为xml文件与json文件 -->
    <script type="text/javascript" src="http://www.jsons.cn/Down/jquery.json2xml.js"></script>
    <script type="text/javascript" src="http://www.jsons.cn/Down/jquery.xml2json.js"></script>
    <!-- 连接后台 -->
    <script type="text/javascript" src="../js/Websocket.js"></script>
    <!-- 导入css -->
    <link rel="stylesheet" href="../css/toolbar.css">
    

    <!-- 示例代码 -->  
    <script type="text/javascript">  
        var graph
        // 程序在此方法中启动   
        function main()  
        {   
            // 定义新连接的图标  
            mxConnectionHandler.prototype.connectImage = new mxImage('../assets/images/connector.gif', 16, 16);  
          
            // 检测浏览器兼容性  
            if (!mxClient.isBrowserSupported())  
            {  
                mxUtils.error('Browser is not supported!', 200, false);  
            }  
            else  
            {  
                // 创建工具栏容器  
                var tbContainer = document.createElement('div');  
                tbContainer.style.position = 'absolute';  
                tbContainer.style.overflow = 'hidden';  
                tbContainer.style.padding = '2px';  
                tbContainer.style.left = '0px';  
                tbContainer.style.top = '26px';  
                tbContainer.style.width = '35px';  
                tbContainer.style.bottom = '0px';  
                tbContainer.style.overflowY='auto';
                document.body.appendChild(tbContainer);  
              
                // 创建工具栏监听工具  
                var toolbar = new mxToolbar(tbContainer);  
                toolbar.enabled = false  
                  
                // 在图形中创建容器   
                container = document.createElement('div'); 
                container.style.position = 'absolute';  
                container.style.overflow = 'hidden';  
                container.style.left = '35px';  
                container.style.top = '26px';  
                container.style.right = '0px';  
                container.style.bottom = '0px';  
                container.style.overflow='scroll'
                container.style.background = 'url("../assets/images/grid.gif")'; 

                // 更换背景按钮点击事件
                $('#bgbut').click(function(){
                    $('.shade,.bgMode').removeClass('hide')
                    //获取单选框的默认值
                    let type = $('input[type=radio][name=xz]:checked').val();
                    // console.log(type)
                    if(type=="color"){
                        $('#selImage').addClass('notclick')
                        $('#selColor').removeClass('notclick')
                    }else if(type=="image"){
                        $('#selColor').addClass('notclick')
                        $('#selImage').removeClass('notclick')
                    }
                })

                // 当更换背景单选框发生改变的时候
                $('input[type=radio][name=xz]').change(function () {
                    if(this.value=="color"){
                        $('#selImage').addClass('notclick')
                        $('#selColor').removeClass('notclick')
                    }else if(this.value=="image"){
                        $('#selColor').addClass('notclick')
                        $('#selImage').removeClass('notclick')
                    }
                })
                
                // 保存背景的信息
                var bgStyle
                // 更换背景颜色的确认按钮
                $('#bgSubmit').click(function(){
                    let type = $('input[type=radio][name=xz]:checked').val();
                    // console.log(type)
                    if(type=="color"){
                        var wholebgcolor=document.getElementById("wholebgcolor").value
                        bgStyle= wholebgcolor 
                        container.style.background = wholebgcolor 
                    }else if(type=="image"){
                        var selBgUrl=document.getElementById("bgChang").value 
                        bgStyle=selBgUrl
                        container.style.background = `url("`+selBgUrl+`")`
                    }
                    $('.shade,.bgMode').addClass('hide')
                })
                document.body.appendChild(container);  
               
                // 解决IE浏览器忽略的样式  
                if (mxClient.IS_QUIRKS)  
                {  
                    document.body.style.overflow = 'hidden';  
                    new mxDivResizer(tbContainer);  
                    new mxDivResizer(container);  
                }  
      
                // 在容器中创建图形和模型  
                var model = new mxGraphModel();  
                graph = new mxGraph(container, model);  
                //决定折叠效果是否启用
                graph.dropEnabled = false;

                //在图中，启用新的连接  
                graph.setConnectable(true);  
                graph.setMultigraph(false);  
    
                // 按下回车和空格键停止编辑  
                var keyHandler = new mxKeyHandler(graph);  
                var rubberband = new mxRubberband(graph);  

                // 连线的样式
            　　var style = graph.getStylesheet().getDefaultEdgeStyle();
            　　style[mxConstants.STYLE_ROUNDED] = true;//圆角连线
            　　style[mxConstants.STYLE_EDGE] = mxEdgeStyle.ElbowConnector; //自己拐弯的连线
                  
                mxGraphModel.setStyle
                //自定义图标
				var style = new Object(); 
				style[mxConstants.STYLE_SHAPE] = mxConstants.SHAPE_IMAGE; 
				style[mxConstants.STYLE_PERIMETER] = mxPerimeter.RectanglePerimeter; 
				style[mxConstants.STYLE_IMAGE] = '../assets/log/yf.jpg';
				graph.getStylesheet().putCellStyle('image', style) 

                //工具栏添加图标
                var addVertex = function(icon, w, h, style)  
                {  
                    var vertex = new mxCell(null, new mxGeometry(0, 0, w, h), style);  
                    vertex.setVertex(true);  
                    addToolbarItem(graph, toolbar, vertex, icon);  
                };  
                addVertex('../assets/images/swimlane.gif', 120, 160, 'shape=swimlane;');
                addVertex('../assets/images/rounded.gif', 100, 40, 'shape=rounded');  
                addVertex('../assets/images/ellipse.gif', 40, 40, 'shape=ellipse');  
                addVertex('../assets/images/rhombus.gif', 40, 40, 'shape=rhombus');  
                addVertex('../assets/images/triangle.gif', 40, 40, 'shape=triangle');  
                addVertex('../assets/images/cylinder.gif', 40, 40, 'shape=cylinder');  
                addVertex('../assets/images/actor.gif', 30, 40, 'shape=actor');  
                addVertex('../assets/images/hexagon.gif', 30, 40, 'shape=hexagon');
				addVertex('../assets/images/cloud.gif', 50, 50, 'shape=cloud');
				addVertex('../assets/images/arrow.gif', 50, 50, 'shape=line');
				addVertex('../assets/images/doubleEllipse.gif', 50, 50, 'shape=doubleEllipse');
                addVertex('../assets/log/yf.jpg', 150, 50, 'image');
                //横线
                // toolbar.addLine();  

                //图形双击事件
                mxGraph.prototype.dblClick = function (evt, cell) {
                    // console.log(cell)
                    
                    //判断是图形还是线型
                    if(cell!=undefined){
                        //console.log(cell)
                        // console.log(cell.edge);//true 线

                        //获取style属性值
                        var cellStyles=String(cell.style)
                        
                        //获取mxcell的id
                        var mxcellId=cell.id

                        //获取文本内容
                        var cellValue=cell.value
                        if(cellValue==undefined){
                            cellValue=''
                        }

                        //获取内置和自己定义的所有样式(固定的)
                        //console.log(graph.getStylesheet().styles)
                        var styles=graph.getStylesheet().styles.defaultVertex
                        //填充颜色
                        var fillColor=styles.fillColor
                        //字体颜色
                        var fontColor=styles.fontColor
                        //边框颜色
                        var strokeColor=styles.strokeColor

                        if(cell.edge){
                            //线型
                            // console.log('线型')
                            //设置表单——内容 
                            document.getElementById("edgeText").value= cellValue
                            document.getElementById('edgeId').value=mxcellId

                            // //获取内置和自己定义的所有样式(固定的)
                            // var styles=graph.getStylesheet().styles.defaultVertex
                            // //边框颜色
                            // var strokeColor=styles.strokeColor
                            // //字体颜色
                            // var fontColor=styles.fontColor
                                
                            //获取style属性值 
                            // var cellStyles=String(cell.style)
                            // 渲染Style
                            //如果cellStyles是null说明是默认的属性，如果不是则是有自定义属性
                            if(cellStyles=='null' ||cellStyles=='undefined'){
                                // console.log('默认属性')
                                //设置表单——字体颜色
                                document.getElementById("edgeFtcolor").value=fontColor
                                //设置表单——字体样式
                                document.getElementById("edgeSelectFontStyle").value=0
                                //设置表单——字体大小
                                document.getElementById("edgeSelectFontSize").value='11'
                                //设置表单——线颜色
                                document.getElementById("edgeStrokeCol").value=strokeColor
                                //设置表单——线宽
                                document.getElementById("edgeStrokeWth").value='1'
                                //设置表单——边框样式
                                document.getElementById("edgeSelectStrokeStyle").value=0
                                //设置表单——箭头是否填充
                                document.getElementById("edgeSelectFillArrow").value=1
                                //设置表单——箭头大小
                                document.getElementById("edgeSelectArrowSize").value='6'
                                
                            }else{
                                // console.log('自定义属性')
                                // console.log(cellStyles)
                                //设置表单——字体颜色
                                // document.getElementById("edgeFtcolor").value=cellStyles.split(";")[0].split("=")[1]
                                document.getElementById("edgeFtcolor").value=getdefaultValue(cellStyles,'fontColor')
                                //设置表单——字体样式
                                // document.getElementById("edgeSelectFontStyle").value=cellStyles.split(";")[1].split("=")[1]
                                document.getElementById("edgeSelectFontStyle").value=getdefaultValue(cellStyles,'fontStyle')
                                //设置表单——字体大小
                                // document.getElementById("edgeSelectFontSize").value=cellStyles.split(";")[2].split("=")[1]
                                document.getElementById("edgeSelectFontSize").value=getdefaultValue(cellStyles,'fontSize')
                                //设置表单——线颜色
                                // document.getElementById("edgeStrokeCol").value=cellStyles.split(";")[3].split("=")[1]
                                document.getElementById("edgeStrokeCol").value=getdefaultValue(cellStyles,'strokeColor')
                                //设置表单——线宽
                                // document.getElementById("edgeStrokeWth").value=cellStyles.split(";")[4].split("=")[1]
                                document.getElementById("edgeStrokeWth").value=getdefaultValue(cellStyles,'strokeWidth')
                                //设置表单——边框样式
                                // document.getElementById("edgeSelectStrokeStyle").value=cellStyles.split(";")[5].split("=")[1]
                                document.getElementById("edgeSelectStrokeStyle").value=getdefaultValue(cellStyles,'fontStyle')
                                //设置表单——箭头是否填充
                                // document.getElementById("edgeSelectFillArrow").value=cellStyles.split(";")[7].split("=")[1]
                                document.getElementById("edgeSelectFillArrow").value=getdefaultValue(cellStyles,'endFill')
                                //设置表单——箭头大小
                                // document.getElementById("edgeSelectArrowSize").value=cellStyles.split(";")[6].split("=")[1]
                                document.getElementById("edgeSelectArrowSize").value=getdefaultValue(cellStyles,'endSize')
                            }

                            //弹出对话框
                            if(cell != undefined){
                                $('.shade,.edgeMode').removeClass('hide')	
                            }
                            
                            //对话框的确认按钮单击事件
                            $('#edgeSubmit').click(function(){
                                var text=document.getElementById('edgeText').value
                                var edgeFtcolor=document.getElementById("edgeFtcolor").value
                                var edgeSelectFontStyle=document.getElementById("edgeSelectFontStyle").value
                                var edgeSelectFontSize=document.getElementById("edgeSelectFontSize").value
                                var edgeStrokeCol=document.getElementById("edgeStrokeCol").value
                                var edgeStrokeWth=document.getElementById("edgeStrokeWth").value
                                var edgeSelectStrokeStyle=document.getElementById("edgeSelectStrokeStyle").value
                                var edgeSelectArrowSize=document.getElementById("edgeSelectArrowSize").value
                                var edgeSelectFillArrow=document.getElementById("edgeSelectFillArrow").value
                                var edgeId=document.getElementById('edgeId').value
                                graph.getModel().beginUpdate();
                                let cells = graph.getSelectionCell();
                                try {
                                    //id
                                    cells.id=edgeId
                                    //设置表单——内容
                                    cells.value = text                                    
                                    //字体颜色
                                    graph.setCellStyles(mxConstants.STYLE_FONTCOLOR, edgeFtcolor, [cells])
                                    //字体样式
                                    graph.setCellStyles(mxConstants.STYLE_FONTSTYLE, edgeSelectFontStyle , [cells])
                                    //字体大小
                                    graph.setCellStyles(mxConstants.STYLE_FONTSIZE, edgeSelectFontSize , [cells])
                                    //线颜色
                                    graph.setCellStyles(mxConstants.STYLE_STROKECOLOR, edgeStrokeCol , [cells])
                                    //线宽
                                    graph.setCellStyles(mxConstants.STYLE_STROKEWIDTH, edgeStrokeWth , [cells])
                                    //线样式
                                    graph.setCellStyles(mxConstants.STYLE_DASHED , edgeSelectStrokeStyle ,[cells])
                                    //箭头大小
                                    graph.setCellStyles(mxConstants.STYLE_ENDSIZE, edgeSelectArrowSize , [cells])
                                    //箭头是否填充
                                    graph.setCellStyles(mxConstants.STYLE_ENDFILL, edgeSelectFillArrow , [cells])
                                    graph.refresh() // 刷新
                                    $('.shade,.edgeMode').addClass('hide')
                                } finally {
                                    graph.getModel().endUpdate();
                                    //移除绑定事件,因为每次双击都会绑定一次
                                    $('#edgeSubmit').unbind('click');
                                }
                            }) 
                        }else{
                            //图形型
                            // console.log('图形')
                            // console.log(cellValue)
                            //设置表单默认——三种颜色选择
                            document.getElementById("ColorOneVal").value='#FF0000'
                            document.getElementById("ColorTwoVal").value='#FFFF00'
                            document.getElementById("ColorThreeVal").value='#33FF00'
                            //设置表单——内容 
                            document.getElementById("text").value= cellValue
                            document.getElementById('cellId').value=mxcellId
                            document.getElementById("customText").value= cellValue
                            document.getElementById('customCellId').value=mxcellId
                            //----------------------------------------------------------------

                            //获取(x,y,whidth,height)
                            // console.log(cell.geometry);
                            var width=cell.geometry.width
                            var height=cell.geometry.height
                            var x=cell.geometry.x
                            var y=cell.geometry.y
                            //设置表单——高度
                            document.getElementById("height").value= height
                            document.getElementById("customHeight").value= height
                            //设置表单——宽度
                            document.getElementById("width").value= width
                            document.getElementById("customWidth").value= width
                            //设置表单——X轴
                            document.getElementById('xAxis').value=x
                            document.getElementById('customX').value=x
                            //设置表单——Y轴
                            document.getElementById('yAxis').value=y
                            document.getElementById('customY').value=y
                            
                            //获取第一个属性 判断是自定义还是自带的属性
                            var firstAttribute=cellStyles.split(";")[0]
                            var equalNum=firstAttribute.split("=").length-1
                            if(equalNum==0){
                                //自定义图形
                                
                                var customValue=cellStyles.split(";")[0]
                                // console.log(customValue)
                                var customLength=customValue.length 
                                var sliceString=cellStyles.slice(customLength+1)
                                // console.log("截取image后："+sliceString)
                                // console.log(sliceString.length)

                                //判断是否是添加的图标，判断有没有result属性,true是添加的图标
                                var addIcon=sliceString.indexOf("result") != -1
                                if(addIcon){
                                    //获取是添加图标的src与result属性，截取不要
                                    var srcLength=sliceString.split(';')[0].length+1
                                    var resultLength=sliceString.split(';')[1].length+1
                                    sliceString=sliceString.slice(srcLength+resultLength)
                                    // console.log(sliceString)
                                }
                                //渲染style属性
                                if(sliceString.length>0){
                                    // console.log('style属性')
                                    // console.log(sliceString)
                                    
                                    //获取的Styel属性给表单
                                    //设置表单——字体颜色
                                    // document.getElementById("customFtcolor").value= sliceString.split(";")[0].split("=")[1]
                                    document.getElementById("customFtcolor").value=getdefaultValue(sliceString,'fontColor')
                                    //设置表单——字体样式
                                    // document.getElementById("customSelectFontStyle").value= sliceString.split(";")[1].split("=")[1]
                                    document.getElementById("customSelectFontStyle").value=getdefaultValue(sliceString,'fontStyle')
                                    //设置表单——字体大小
                                    // document.getElementById("customSelectFontSize").value= sliceString.split(";")[2].split("=")[1]
                                    document.getElementById("customSelectFontSize").value=getdefaultValue(sliceString,'fontSize')
                                    //设置表单——跳转路径
                                    document.getElementById("customJumpPath").value=cell.CUSTOM_COLOR_JUMPPATH
                                }else if(sliceString.length<=0){
                                    // console.log('默认属性')
                                    // console.log(sliceString)
                                    //--------------小于0(默认值给表单)----------------
                                    //设置表单——字体颜色
                                    document.getElementById("customFtcolor").value= fontColor
                                    //设置表单——字体样式
                                    document.getElementById("customSelectFontStyle").value= 0
                                    //设置表单——字体大小
                                    document.getElementById("customSelectFontSize").value= '11'
                                    //设置表单——跳转路径
                                    document.getElementById("customJumpPath").value=""
                                    
                                }

                                //弹出对话框
                                if(cell != undefined){
                                    $('.shade,.customMode').removeClass('hide')	
                                }

                                //自定义图标对话框的确认按钮单击事件
                                $('#customSubmit').click(function(){
                                    var customText=document.getElementById('customText').value
                                    var customSelectFontStyle=document.getElementById('customSelectFontStyle').value
                                    var customSelectFontSize=document.getElementById('customSelectFontSize').value
                                    var customFtcolor=document.getElementById("customFtcolor").value
                                    var customHeight=document.getElementById("customHeight").value
                                    var customWidth=document.getElementById("customWidth").value
                                    var customX=document.getElementById("customX").value
                                    var customY=document.getElementById("customY").value
                                    var customCellId=document.getElementById('customCellId').value
                                    var customJumpPathVal= document.getElementById("customJumpPath").value
                                    
                                    graph.getModel().beginUpdate();
                                    let cells = graph.getSelectionCell();
                                    try {
                                        //id
                                        cells.id=customCellId
                                        //文本
                                        cells.value = customText
                                        //字体颜色
                                        graph.setCellStyles(mxConstants.STYLE_FONTCOLOR, customFtcolor, [cells])
                                        //字体样式
                                        graph.setCellStyles(mxConstants.STYLE_FONTSTYLE, customSelectFontStyle , [cells])
                                        //字体大小
                                        graph.setCellStyles(mxConstants.STYLE_FONTSIZE, customSelectFontSize , [cells])
                                        //跳转路径
                                        cells.CUSTOM_COLOR_JUMPPATH=customJumpPathVal
                                        //高宽
                                        var geo=graph.getCellGeometry(cell)
                                        geo=geo.clone()
                                        geo.width=parseInt(customWidth)
                                        geo.height=parseInt(customHeight)
                                        geo.x=parseInt(customX)
                                        geo.y=parseInt(customY)
                                        graph.getModel().setGeometry(cell, geo);

                                        graph.refresh() // 刷新
                                        $('.shade,.customMode').addClass('hide')
                                    } finally {
                                        graph.getModel().endUpdate();
                                        //移除绑定事件,因为每次双击都会绑定一次
                                        $('#customSubmit').unbind('click');
                                    }
                                })   
                            }else{
                                //自带的图形
                                //获取shape=XXXX，计算有多少字符，截取后
                                //总字符如果大于0说明有样式(动态添加的样式)，如果小于0表示没有样式(只有自带的样式)
                                var shapeValue=cellStyles.split(";")[0].split("=")[1]
                                if(shapeValue!=undefined){
                                    var shapeLength=6+shapeValue.length    
                                }
                                var sliceString=cellStyles.slice(shapeLength+1)
                                // console.log("截取shape=XXXX后："+sliceString)
                                //渲染Style属性
                                if(sliceString.length>0){
                                    console.log(sliceString)
                                    //--------------大于0(获取style给表单)----------------
                                    //设置表单——文本变量
                                    document.getElementById("textVariable").value=cell.CUSTOM_TEXT_VARIABLE
                                    //设置表单——填充变量
                                    document.getElementById("colorVariable").value=cell.CUSTOM_COLOR_VARIABLE
                                    //设置表单——动态的三种表达式改变颜色
                                    document.getElementById("colorSelOne").value=cell.CUSTOM_COLORSELECTONE
                                    document.getElementById("colorSelTwo").value=cell.CUSTOM_COLORSELECTTWO
                                    document.getElementById("colorSelThree").value=cell.CUSTOM_COLORSELECTTHREE
                                    //设置表单——动态的三种颜色选择
                                    //动态判断颜色 三个填充颜色 
                                    document.getElementById("ColorOneVal").value=cell.CUSTOM_COLOR_ONE_VALUE
                                    document.getElementById("ColorTwoVal").value=cell.CUSTOM_COLOR_TWO_VALUE
                                    document.getElementById("ColorThreeVal").value=cell.CUSTOM_COLOR_THREE_VALUE
                                    //设置表单——跳转路径
                                    document.getElementById("jumpPath").value=cell.CUSTOM_COLOR_JUMPPATH
                                    //设置表单——填充
                                    // document.getElementById("bgcolor").value= sliceString.split(";")[0].split("=")[1]
                                    document.getElementById("bgcolor").value=getdefaultValue(sliceString,'fillColor')
                                    //设置表单——字体颜色
                                    // document.getElementById("ftcolor").value= sliceString.split(";")[1].split("=")[1]
                                    document.getElementById("ftcolor").value=getdefaultValue(sliceString,'fontColor')
                                    //设置表单——字体样式
                                    // document.getElementById("selectFontStyle").value= sliceString.split(";")[2].split("=")[1]
                                    document.getElementById("selectFontStyle").value=getdefaultValue(sliceString,'fontStyle')
                                    //设置表单——字体大小
                                    // document.getElementById("selectFontSize").value= sliceString.split(";")[3].split("=")[1]
                                    document.getElementById("selectFontSize").value=getdefaultValue(sliceString,'fontSize')
                                    //设置表单——边线宽度
                                    // document.getElementById("strokeWth").value= sliceString.split(";")[4].split("=")[1]
                                    document.getElementById("strokeWth").value=getdefaultValue(sliceString,'strokeWidth')
                                    //设置表单——边线颜色
                                    // document.getElementById("strokeCol").value= sliceString.split(";")[5].split("=")[1]
                                    document.getElementById("strokeCol").value=getdefaultValue(sliceString,'strokeColor')
                                    //设置表单——边线样式
                                    // document.getElementById("selectStrokeStyle").value= sliceString.split(";")[6].split("=")[1]  
                                    document.getElementById("selectStrokeStyle").value=getdefaultValue(sliceString,'dashed')              
                                }else{
                                    //--------------小于0(默认值给表单)----------------
                                    //设置表单——文本变量
                                    document.getElementById("textVariable").value=""
                                    //设置表单——填充变量
                                    document.getElementById("colorVariable").value=""
                                    //设置表单——动态的三种情况改变颜色
                                    document.getElementById("colorSelOne").value=""
                                    document.getElementById("colorSelTwo").value=""
                                    document.getElementById("colorSelThree").value=""
                                    //设置表单——跳转路径
                                    document.getElementById("jumpPath").value=""
                                    //设置表单——填充颜色
                                    document.getElementById("bgcolor").value= fillColor
                                    //设置表单——边框线样式
                                    document.getElementById("selectStrokeStyle").value= 0
                                    //设置表单——边框线宽度
                                    document.getElementById("strokeWth").value='1'
                                    //设置表单——边框线颜色
                                    document.getElementById("strokeCol").value= strokeColor
                                    //设置表单——字体颜色
                                    document.getElementById("ftcolor").value= fontColor
                                    //设置表单——字体样式
                                    document.getElementById("selectFontStyle").value= 0
                                    //设置表单——字体大小
                                    document.getElementById("selectFontSize").value= '11'
                                }
                                    
                                //弹出对话框
                                if(cell != undefined){
                                    $('.shade,.mode').removeClass('hide')	
                                }
                                
                                //对话框的确认按钮单击事件
                                $('#submit').click(function(){
                                    var text=document.getElementById('text').value
                                    var selectFStlye=document.getElementById('selectFontStyle').value
                                    var selectFSize=document.getElementById('selectFontSize').value
                                    var strokeWth= document.getElementById("strokeWth").value
                                    var bgcolor=document.getElementById("bgcolor").value
                                    var strokeCol=document.getElementById("strokeCol").value
                                    var ftcolor=document.getElementById("ftcolor").value
                                    var selectStrokeStyle=document.getElementById("selectStrokeStyle").value
                                    var cellHeight=document.getElementById("height").value
                                    var cellWidth=document.getElementById("width").value
                                    var xAxis=document.getElementById("xAxis").value
                                    var yAxis=document.getElementById("yAxis").value
                                    var cellId=document.getElementById('cellId').value
                                    var textVariable=document.getElementById("textVariable").value
                                    var colorVariable=document.getElementById("colorVariable").value
                                    var colorSelOne=document.getElementById("colorSelOne").value
                                    var colorSelTwo=document.getElementById("colorSelTwo").value
                                    var colorSelThree=document.getElementById("colorSelThree").value
                                    var colorOneVal=document.getElementById("ColorOneVal").value
                                    var colorTwoVal=document.getElementById("ColorTwoVal").value
                                    var colorThreeVal=document.getElementById("ColorThreeVal").value
                                    var jumpPathVal=document.getElementById("jumpPath").value
                                    graph.getModel().beginUpdate();
                                    let cells = graph.getSelectionCell();
                                    try {
                                        //文本变量
                                        cells.CUSTOM_TEXT_VARIABLE=textVariable
                                        //填充变量
                                        cells.CUSTOM_COLOR_VARIABLE=colorVariable
                                        //三种动态颜色改变表达式
                                        cells.CUSTOM_COLORSELECTONE=colorSelOne
                                        cells.CUSTOM_COLORSELECTTWO=colorSelTwo
                                        cells.CUSTOM_COLORSELECTTHREE=colorSelThree
                                        //三种颜色选择
                                        cells.CUSTOM_COLOR_ONE_VALUE=colorOneVal
                                        cells.CUSTOM_COLOR_TWO_VALUE=colorTwoVal
                                        cells.CUSTOM_COLOR_THREE_VALUE=colorThreeVal
                                        //跳转路径
                                        cells.CUSTOM_COLOR_JUMPPATH=jumpPathVal
                                        //id
                                        cells.id=cellId
                                        //文本
                                        cells.value = text
                                        //填充
                                        graph.setCellStyles(mxConstants.STYLE_FILLCOLOR, bgcolor , [cells])
                                        //字体颜色
                                        graph.setCellStyles(mxConstants.STYLE_FONTCOLOR, ftcolor, [cells])
                                        //字体样式
                                        graph.setCellStyles(mxConstants.STYLE_FONTSTYLE, selectFStlye , [cells])
                                        //字体大小
                                        graph.setCellStyles(mxConstants.STYLE_FONTSIZE, selectFSize , [cells])
                                        //边框线宽
                                        graph.setCellStyles(mxConstants.STYLE_STROKEWIDTH, strokeWth , [cells])
                                        //边框颜色
                                        graph.setCellStyles(mxConstants.STYLE_STROKECOLOR, strokeCol , [cells])
                                        //边框线样式
                                        graph.setCellStyles(mxConstants.STYLE_DASHED , selectStrokeStyle ,[cells])
                                        //高宽
                                        var geo=graph.getCellGeometry(cell)
                                        // console.log(cell)
                                        geo=geo.clone()
                                        geo.width=parseInt(cellWidth)
                                        geo.height=parseInt(cellHeight)
                                        geo.x=parseInt(xAxis)
                                        geo.y=parseInt(yAxis)
                                        graph.getModel().setGeometry(cell, geo);
                                       
                                        graph.refresh() // 刷新
                                        $('.shade,.mode').addClass('hide')
                                    } finally {
                                        graph.getModel().endUpdate();
                                        //移除绑定事件,因为每次双击都会绑定一次
                                        $('#submit').unbind('click');
                                    }
                                })   
                            }
                            //equalNum else
                        }
                    }
                };       

                var cells = new Array()
                //复制
                var ls_button = mxUtils.button('复制', function(evt)  
                {  
                    cells = graph.getSelectionCells()
                    mxClipboard.copy(graph,cells)
                    mxClipboard.paste(graph)
                });  
                ls_button.style.position = 'absolute';  
                ls_button.style.left = '290px';  
                ls_button.style.top = '2px';  
                document.body.appendChild(ls_button);  

                //清空按钮
                var clearbut = mxUtils.button('清空', function(evt)
				{   
                    cells=null
					graph.removeCells(graph.getChildVertices(graph.getDefaultParent()))
                    // 刷新页面
                    location.reload();
				});
				clearbut.style.position = 'absolute';
				clearbut.style.left = '235px';
				clearbut.style.top = '2px';
				document.body.appendChild(clearbut);

                //字符串替换的方法
                function changeStr(str,index,changeStr){
                    return str.substr(0, index) + changeStr+ str.substr(index + changeStr.length);
                }
             
                //导出xml文件按钮
                var dc_button = mxUtils.button('导出xml文件', function(evt)
				{  
                    var encoder = new mxCodec();
					//console.log('122',graph.getModel())
                    
                    //var node = encoder.encode(modelxml);
					var node = encoder.encode(graph.getModel());
					//获取标准xml
					//console.log('123',mxUtils.getPrettyXml(node));
					
					//获取去除空格xml
					var xmlString=mxUtils.getXml(node);
					var xml=mxUtils.getPrettyXml(node);
                    // console.log(xml)
                    //-------------------删除mxcell没有Style的----------------------
                    // console.log(xml)

                    //截取的第一部分
                    var firstmxCellindexOf = xml.indexOf("<mxCell")
                    var first=xml.substr(0,firstmxCellindexOf)
                    // console.log(first)
                    

                    //截取到mxcell没有style的部分 var mxcellNoStyle
                    var mxcellStr=xml.split('root>')[1].split('style=')[0]
                    // console.log(mxcellStr) 
                    var lastindexOf = mxcellStr.lastIndexOf(">"); //获取最后 /> 字符串的位置
                    // console.log(lastindexOf)
                    var mxcellNoStyle=mxcellStr.substr(0,lastindexOf+1)
                    // console.log(mxcellNoStyle)
                    
                    // //截取第一部分剩下的
                    var delFirst=xml.substr(first.length,xml.length)
                    // console.log(delFirst)
                    
                    // //截取的第二部分
                    var last=delFirst.substr(mxcellNoStyle.length,delFirst.length)
                    // console.log(last)

                    // //拼接第一部分和第二部分(去除Xml中开头没有Style的mxcell)
                    var newXmlStr=first+last
                    //  console.log(newXmlStr)



                    //在xml<mxGraphModel>标签中添加背景的信息
                    //获取当前的画板的背景信息 保存在bgStyle变量中
                    var mxGraphModelStr=newXmlStr.split('>')[0]
                    
                    //获取画板背景值
                    if(bgStyle!=undefined){
                        //获取选中的画板的背景值
                        var newStrBgStyle=' background="'+bgStyle+'"'
                        newXmlStr=newXmlStr.slice(0, 13)+newStrBgStyle+newXmlStr.slice(13)
                    }
                    if(mgBgStyle!=undefined){
                        //获取导入时的画板的背景值
                        var newStrBgStyle=' background="'+mgBgStyle+'"'
                        newXmlStr=newXmlStr.slice(0, 13)+newStrBgStyle+newXmlStr.slice(13)
                    }
                    
              
                    // 保存xml
                    const downLink = document.createElement('a')
                    downLink.download = 'toolbar.xml'
                    const blob = new Blob([newXmlStr])
                    
                    
                    downLink.href = URL.createObjectURL(blob)
                    document.body.appendChild(downLink)
                    downLink.click()
                    
                    document.body.removeChild(downLink)
                   
                    //清空图表
                    graph.removeCells(graph.getChildVertices(graph.getDefaultParent()))
 
                    // 刷新页面
                    location.reload()
                    
				});
				dc_button.style.position = 'absolute';
				dc_button.style.left = '130px';
				dc_button.style.top = '2px';
				document.body.appendChild(dc_button);

                // 按下del键删除
                var keyHandler = new mxKeyHandler(graph);
				keyHandler.bindKey(46, function(evt)
				{
					if (graph.isEnabled())
					{
						graph.removeCells()
					}
				})
                
                // 替换的id值
                var idVal=0
                //在实现撤销删除方法之前，首先要对graph面板添加监听：
                // 实现id不重复
                var undoMng = new mxUndoManager(); 
                var listener = function(sender, evt){ 
                    // console.log(idVal)
                    undoMng.undoableEditHappened(evt.getProperty('edit')); 
                    
                    //获取倒数第二个id，后面添加的id就在倒数第二个基础上+1
                    //获取所有图形
                    var MxCells= evt.getProperty('edit')
                    // console.log(MxCells)
                    //获取所有的图形的个数
                    var mxCelllsLength=MxCells.changes.length
                    // console.log(mxCelllsLength)
                    //存放当前所有图形的id
                    var mxCellId=[]
                    
                    for(var i=0;i<mxCelllsLength;i++){
                        if(MxCells.changes[i].child!=undefined){
                            mxCellId[i]= MxCells.changes[i].child.id
                        }
                    }
                    // console.log(mxCellId)
                    //保存最大的id值
                    var maxId
                    //判断获取图形的id长度，因为一开始加载id长度会大于1,也有可能会等于1
                    if(mxCellId.length>1){
                        // console.log('长度大于1')  
                        //去除数组中的空值
                        for(var i = 0; i < mxCellId.length; i++) {
                            if(mxCellId[i] == undefined) {
                                mxCellId.splice(i,1);
                                i = i - 1; 
                                }
                        } 
                        
                        //获取最大的id值
                        maxId = Math.max.apply(null,mxCellId);
                        var max=maxId+1
                        idVal=max.toString()
                    }else{
                        // console.log('长度等于1')
                        // console.log(mxCellId)
                        maxId=mxCellId
                        // console.log(maxId[0])
                        //改变当前的图形id为0
                        // console.log(MxCells)
                        
                        if(MxCells.changes[0].child!=undefined){
                            // console.log("改变前："+MxCells.changes[0].child.id)
                            MxCells.changes[0].child.id=idVal
                            // console.log("改变后："+MxCells.changes[0].child.id)
                            if(graph.isEnabled()){
                                idVal++
                            }
                        }
                    }
                    //键盘Del事件
                    keyHandler.bindKey(46, function(evt)
                    {
                        if (graph.isEnabled())
                        {
                            var removeCells=graph.removeCells()
                            //有删除到mxcell
                            if(removeCells.length>0){
                                idVal--
                            }

                        }
                    })
                }
                
                graph.getModel().addListener(mxEvent.UNDO, listener); 
                graph.getView().addListener(mxEvent.UNDO, listener);

                // 撤销
                var dr_button = mxUtils.button('撤销', function(evt)
				{	
                    undoMng.undo()
				});
				dr_button.style.position = 'absolute';
				dr_button.style.left = '430px';
				dr_button.style.top = '2px';
				document.body.appendChild(dr_button);

                var iconIndex=0
                // 添加工具栏图标
                var icon_button = mxUtils.button('添加图标', function(evt)
				{	
                    // 弹出对话框 
                    $('.iconMode').removeClass('hide')	 
                    // 给图标名称添加编号 iconName
                   
                    //确认添加按钮  
                    $('#iconSubmit').click(function(){
                        //获取图片的路径
                        //添加到工具栏中
                        var simpleFile = document.getElementById("iconFile").files[0]
                        if(simpleFile!=undefined){
                            // console.log(simpleFile)
                            var reader = new FileReader()
                            //将文件以二进制文件读入页面中
                            reader.readAsBinaryString(simpleFile)
                        
                            //保存图片名称、路径
                            var iconName,src
                            reader.onload = function(){
                                //获取图标名称
                                iconName=simpleFile.type.split("/")[0]+iconIndex
                                //获取图标路径
                                src = "data:" + simpleFile.type + ";base64," + window.btoa(this.result);
                                console.log(iconName)
                                //自定义图标样式
                                var style = new Object(); 
                                style[mxConstants.STYLE_SHAPE] = mxConstants.SHAPE_IMAGE; 
                                style[mxConstants.STYLE_PERIMETER] = mxPerimeter.RectanglePerimeter; 
                                style[mxConstants.STYLE_IMAGE] = src;
                                graph.getStylesheet().putCellStyle(iconName, style) 
                                //添加图标
                                addVertex(src, 150, 50,iconName+';src='+simpleFile.type+';result='+window.btoa(this.result)+";");

                                //获取所有的图标的个数
                                var iconCount=document.getElementsByClassName('mxToolbarMode').length

                                //获取工具栏div(tbContainer)、画板div(container)
                                //根据图标的个数去改变工具栏和画板的宽度
                                //工具栏一条22个图标
                                var toolIconCount=19
                                if(iconCount>=toolIconCount){
                                    var multiple=parseInt((iconCount/toolIconCount).toString().split('.')[0])
                                    if(multiple>=1){
                                        //改变工具栏的宽度
                                        tbContainer.style.width='47px'
                                        //改变画板div的宽度
                                        container.style.left='50px';
                                    }
                                    
                                }

                                //重置选择文件
                                document.getElementById("iconFile").value=''
                                //删除在弹窗添加的icon图标
                                $('#result').empty()
                                //移除绑定事件,因为每次双击都会绑定一次
                                $('#iconSubmit').unbind('click');
                                //关闭弹出框
                                $('.shade,.iconMode').addClass('hide')
                                
                            }
                        }else{
                            var result = document.getElementById("result");
                            result.innerHTML = '<span id="iconTip">请选择图标</span>';
                        }
                    })    
                    iconIndex++
                });
				icon_button.style.position = 'absolute';
				icon_button.style.left = '490px';
				icon_button.style.top = '2px';
				document.body.appendChild(icon_button);
                

                //右键菜单事件
                mxEvent.disableContextMenu(document.body);
                graph.popupMenuHandler.factoryMethod = function(menu, cell, evt)
                {
                    if (cell != null) {
                        menu.addItem('复制', null, function() {
                            var cells = new Array()
                            cells = graph.getSelectionCells()
                            mxClipboard.copy(graph,cells)
                            mxClipboard.paste(graph)
                        })
                       
                    } else {
                        menu.addItem('更换背景', null, function() {
                            $('.shade,.bgMode').removeClass('hide')
                            //获取单选框的默认值
                            let type = $('input[type=radio][name=xz]:checked').val();
                            // console.log(type)
                            if(type=="color"){
                                $('#selImage').addClass('notclick')
                                $('#selColor').removeClass('notclick')
                            }else if(type=="image"){
                                $('#selColor').addClass('notclick')
                                $('#selImage').removeClass('notclick')
                            }
                        })
                       
                    }
                    menu.addSeparator();
                    menu.addItem('清空', null, function() {
                        graph.removeCells(graph.getChildVertices(graph.getDefaultParent()))
                    })
                    menu.addItem('撤销', null, function() {
                        undoMng.undo()
                    })
                }

            }  
        }  
        //获取style的值
		function getdefaultValue(style,word){
            console.log(word)
			var wordLocation=style.indexOf(word)
			var wordValue=style.slice(wordLocation)
            wordValue=wordValue.split("=")[1]
            if(wordValue==undefined){
                return ''
            }else(
                wordValue=wordValue.split(";")[0]
            )
			
            return wordValue
			
		}

        //拖放图像时执行
        function addToolbarItem(graph, toolbar, prototype, image)  
        {  
            // 添加、删除功能  
            var funct = function(graph, evt, cell)  
            {  
                graph.stopEditing(false);  
  
                var pt = graph.getPointForEvent(evt);  
                var vertex = graph.getModel().cloneCell(prototype);  
                vertex.geometry.x = pt.x;  
                vertex.geometry.y = pt.y;  
                      
                graph.addCell(vertex);  
                graph.setSelectionCell(vertex);  
            }  
  
            // 创建拖动预览图标  
            var img = toolbar.addMode(null, image, funct);  
            mxUtils.makeDraggable(img, graph, funct);  
        }  
 
        //读取选中的文件 导入xml文件
        //保存背景值
        var mgBgStyle
        function uploadFile(){ 
            //清空图表
            graph.removeCells(graph.getChildVertices(graph.getDefaultParent()))
            //默认背景图
            container.style.background = `url("../assets/images/grid.gif")`
            var selectFiles = document.getElementById("selectFiles").files[0];
            var reader =new FileReader();
            reader.readAsText(selectFiles)
            
            reader.onload=function(evt){
                var pointsTxt=evt.target.result;
                //把xml数据转换为json数据(但是属性带@符号)
                // console.log(pointsTxt)
                
                var json = $.xml2json(pointsTxt);
                // console.log(json)
                //把json数据转换为字符串
                var jsonStr=JSON.stringify(json)
                
                //替换所有的@符号
                jsonStr= jsonStr.replace(/@/g,'')
                
                //把jsonStr转回json数据
                var newJson=eval("("+jsonStr+")")
                // console.log(newJson)

                //获取背景值
                mgBgStyle=newJson.background

                var mxCells=newJson.root.mxCell
                
                let cellsObj = {},edges = []
                graph.getModel().beginUpdate()
                var parent = graph.getDefaultParent();
                // console.log(mxCells[0])
                // console.log(mxCells[0].mxGeometry)
                try {
                    
                    //出现只有一个图形的情况 会出现undefined
                    var mxCellsLength=mxCells.length
                    if(mxCells.length==undefined){
                        mxCellsLength=1
                    }
                    

                    // 循环处理节点cell 同时找出对应关系的线
                    for (let i = 0; i < mxCellsLength; i++) {
                        let mxCell 
                        if(mxCellsLength==1){
                            mxCell = mxCells
                        }else{
                            mxCell = mxCells[i]
                        }
                        
                        let mxCellGeometry =mxCell.mxGeometry
                        if (mxCell.vertex) {
                            const geometry = mxCellGeometry
                            var vertex = graph.insertVertex(
                                parent,
                                null,
                                mxCell.value,
                                geometry.x,
                                geometry.y,
                                geometry.width,
                                geometry.height,
                                mxCell.style
                            )
                            vertex.id = mxCell.id;
                            //动态的表达式变量
                            vertex.CUSTOM_COLOR_VARIABLE=mxCell.CUSTOM_COLOR_VARIABLE
                            //动态的数据内容
                            vertex.CUSTOM_TEXT_VARIABLE=mxCell.CUSTOM_TEXT_VARIABLE
                            //动态三种表达式
                            vertex.CUSTOM_COLORSELECTONE=mxCell.CUSTOM_COLORSELECTONE
                            vertex.CUSTOM_COLORSELECTTWO=mxCell.CUSTOM_COLORSELECTTWO
                            vertex.CUSTOM_COLORSELECTTHREE=mxCell.CUSTOM_COLORSELECTTHREE
                            //动态三种颜色选择
                            vertex.CUSTOM_COLOR_ONE_VALUE=mxCell.CUSTOM_COLOR_ONE_VALUE
                            vertex.CUSTOM_COLOR_TWO_VALUE=mxCell.CUSTOM_COLOR_TWO_VALUE
                            vertex.CUSTOM_COLOR_THREE_VALUE=mxCell.CUSTOM_COLOR_THREE_VALUE
                            //跳转路径
                            vertex.CUSTOM_COLOR_JUMPPATH=mxCell.CUSTOM_COLOR_JUMPPATH

                            cellsObj["vertex" + vertex.id] = vertex;
                            
                        } else if (mxCell.edge) {
                            edges.push(mxCell)
                        } else {
                            continue
                        }
                    }
                   
                    //拼接节点关联线
                    // console.log(cellsObj)
                    for (let i = 0; i < edges.length; i++) {
                        let edge = edges[i]
                        geometry = edge.mxGeometry
                        // console.log(edge)
                        // console.log(edge.source)    
                        graph.insertEdge(
                            parent,
                            null,
                            edge.value,
                            cellsObj["vertex" + edge.source],
                            cellsObj["vertex" + edge.target],
                            edge.style
                        ).setId(edge.id)                   
                    }
                    
                    if(mgBgStyle!=undefined){
                        if(mgBgStyle.length==7){
                            container.style.background = mgBgStyle
                        }else{
                            container.style.background = `url("`+mgBgStyle+`")`
                        }
                        document.body.appendChild(container) 
                    }  
                } 
                finally {
                    graph.getModel().endUpdate();
                } 
            }
        }
    
        //读取选中的图片  添加图标
        function readPicture(){
            // 检查是否为图像类型
            var simpleFile = document.getElementById("iconFile").files[0];
            if(!/image\/\w+/.test(simpleFile.type)) {
                alert("请确保文件类型为图像类型");
                //重置选择文件
                document.getElementById("iconFile").value=''
                return false;
            }
            var reader = new FileReader();
            // 将文件以二进制文件读入页面中
            reader.readAsBinaryString(simpleFile);
            reader.onload = function(f){
                var result = document.getElementById("result");
                var src = "data:" + simpleFile.type + ";base64," + window.btoa(this.result);
                result.innerHTML = '<img src ="'+src+'"/>';
            }
        }

        //所有取消按钮的点击事件
        $(function(){
            $('#quxiao').click(function(){
                $('.shade,.mode').addClass('hide')
            })
            $('#bgquxiao').click(function(){
                $('.shade,.bgMode').addClass('hide')
            })
            $('#edgeQuxiao').click(function(){
                $('.shade,.edgeMode').addClass('hide')
            })
            $('#customQuxiao').click(function(){
                $('.shade,.customMode').addClass('hide')
            })
            $('#iconQuxiao').click(function(){
                //重置选择文件
                document.getElementById("iconFile").value=''
                //删除在弹窗添加的icon图标
                $('#result').empty()
                $('.shade,.iconMode').addClass('hide')
            })
            //点击黑色对话框阴影背景的时候会关闭对话框
            $('.shade').click(function(){
                $('.shade,.customMode').addClass('hide')
                $('.shade,.edgeMode').addClass('hide')
                $('.shade,.bgMode').addClass('hide')
                $('.shade,.mode').addClass('hide')
            })
        });
        
    </script>  
</head>  
  
<!-- 页面载入后启动程序. -->  
<body onload="main()">  
    <button id="dr">导入xml文件</button>
    <div id="graphContainer" style="filter:alpha(opacity=0);cursor: pointer; opacity: 0; position: absolute;  width: 120px;margin: -18px 0 0 -6px ;margin: -16px 0 0 -6px\9;height:20px\9;overflow: hidden; ">
        <input type="file" onchange="uploadFile()" name="upload" id="selectFiles"/>
    </div>
    <button id="bgbut">更换背景</button>
    <!-- 对话框阴影 -->
    <div class="shade hide"></div>
    <!-- cell自带图形属性对话框 -->
    <div class="mode hide">
        <div style="margin: -20px 50px">
            <form action="/cmdb/assets/" method="post" id="formId">
                <div><h2>修改图形样式</h2></div>
                <div>
                    <span>ID：</span><input type="text" name="id" id="cellId"  readonly="readonly">
                    <br/>
                    <span class="toop"></span>
                </div>
                <div>
                    <span>文本：</span><input type="text" name="text" id="text">
                </div>
                <div>
                    <span>文本变量：</span><input type="text" name="text" id="textVariable">
                </div>
                <div>
                    <span>填充颜色：</span><input type="color" name="bgcolor" id="bgcolor">
                </div>
                <!-- 动态三种颜色选择表达式 -->
                <div><span>颜色表达式：</span></div>
                <div>
                    <input type="color" name="bgcolor" id="ColorOneVal">
                    <input type="text" id="colorSelOne" value="">
                </div>
                <div>
                    <input type="color" name="bgcolor" id="ColorTwoVal">
                    <input type="text" id="colorSelTwo" value="">
                </div>
                <div>
                    <input type="color" name="bgcolor" id="ColorThreeVal">
                    <input type="text" id="colorSelThree" value="">
                </div>
                <div>
                    <span>填充变量：</span><input type="text" name="text" id="colorVariable">
                </div>
                <div>
                    <span>跳转路径：</span><input type="text" name="text" id="jumpPath" placeholder="https://www.baidu.com/">
                </div>
                <div>
                    <span>高度：</span><input type="text" name="height" id="height">
                </div>
                <div>
                    <span>宽度：</span><input type="text" name="width" id="width">
                </div>
                <div>
                    <span>X轴：</span><input type="text" name="x" id="xAxis">
                </div>
                <div>
                    <span>Y轴：</span><input type="text" name="y" id="yAxis">
                </div>
                <div>
                    <span>边框线样式：</span>
                    <select id="selectStrokeStyle">
                        <option value="0">实线</option>
                        <option value="1">虚线</option>
                    </select>
                </div>
                <div>
                    <span>边框线宽：</span>
                    <select id="strokeWth">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                        <option>6</option>
                        <option>7</option>
                        <option>8</option>
                        <option>9</option>
                        <option>10</option>
                    </select>
                </div>
                <div>
                    <span>边框线颜色：</span><input type="color" name="strokeCol" id="strokeCol">
                </div>
                <div>
                    <span>字体颜色：</span><input type="color" name="ftcolor" id="ftcolor">
                </div>
                <div>
                    <span>字体样式：</span>
                    <select id="selectFontStyle">
                        <option value="0">常规</option>
                        <option value="1">粗体</option>
                        <option value="2">斜体</option>
                        <option value="3">粗斜体</option>
                        <option value="4">下划线</option>
                        <option value="8">中划线</option>
                    </select>
                </div>
                <div>
                    <span>字体大小：</span>
                    <select id="selectFontSize">
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="14">14</option>
                        <option value="16">16</option>
                        <option value="18">18</option>
                        <option value="20">20</option>
                        <option value="22">22</option>
                        <option value="26">26</option>
                        <option value="28">28</option>
                        <option value="36">36</option>
                        <option value="48">48</option>
                        <option value="56">56</option>
                        <option value="72">72</option>
                    </select>
                </div>
                <div>
                    <input id="submit" type="button" value="确认">
                    <input id="quxiao" type="button" value="取消">
                </div>
            </form>
        </div>
    </div>
    <!-- cell自定义图形属性对话框 -->
    <div class="customMode hide">
        <div style="margin: -20px 50px">
            <form action="/cmdb/assets/" method="post" id="customFormId">
                <div><h2>修改图形样式</h2></div>
                <div>
                    <span>ID：</span><input type="text" name="id" id="customCellId"  readonly="readonly">
                </div>
                <div>
                    <span>内容：</span><input type="text" name="customText" id="customText">
                </div>
                <div>
                    <span>高度：</span><input type="text" name="customHeight" id="customHeight">
                </div>
                <div>
                    <span>宽度：</span><input type="text" name="customWidth" id="customWidth">
                </div>
                <div>
                    <span>X轴：</span><input type="text" name="customX" id="customX">
                </div>
                <div>
                    <span>Y轴：</span><input type="text" name="customY" id="customY">
                </div>
                <div>
                    <span>字体颜色：</span><input type="color" name="customFtcolor" id="customFtcolor">
                </div>
                <div>
                    <span>字体样式：</span>
                    <select id="customSelectFontStyle">
                        <option value="0">常规</option>
                        <option value="1">粗体</option>
                        <option value="2">斜体</option>
                        <option value="3">粗斜体</option>
                        <option value="4">下划线</option>
                        <option value="8">中划线</option>
                    </select>
                </div>
                <div>
                    <span>字体大小：</span>
                    <select id="customSelectFontSize">
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="14">14</option>
                        <option value="16">16</option>
                        <option value="18">18</option>
                        <option value="20">20</option>
                        <option value="22">22</option>
                        <option value="26">26</option>
                        <option value="28">28</option>
                        <option value="36">36</option>
                        <option value="48">48</option>
                        <option value="56">56</option>
                        <option value="72">72</option>
                    </select>
                </div>
                <div>
                    <span>跳转路径：</span><input type="text" name="text" id="customJumpPath"  placeholder="https://www.baidu.com/">
                </div>
                <div>
                    <input id="customSubmit" type="button" value="确认">
                    <input id="customQuxiao" type="button" value="取消">
                </div>
            </form>
        </div>
    </div>
    <!-- edge线形属性对话框 -->
    <div class="edgeMode hide">
        <div style="margin: -20px 50px">
            <form action="/cmdb/assets/" method="post" id="edgeFormId">
                <div><h2>修改线形样式</h2></div>
                <div>
                    <span>ID：</span><input type="text" name="id" id="edgeId"  readonly="readonly">
                    <br/>
                    <span class="toop"></span>
                </div>
                <div>
                    <span>内容：</span><input type="text" name="text" id="edgeText">
                </div>
                <div>
                    <span>字体颜色：</span><input type="color" name="edgeFtcolor" id="edgeFtcolor">
                </div>
                <div>
                    <span>字体样式：</span>
                    <select id="edgeSelectFontStyle">
                        <option value="0">常规</option>
                        <option value="1">粗体</option>
                        <option value="2">斜体</option>
                        <option value="3">粗斜体</option>
                        <option value="4">下划线</option>
                        <option value="8">中划线</option>
                    </select>
                </div>
                <div>
                    <span>字体大小：</span>
                    <select id="edgeSelectFontSize">
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="14">14</option>
                        <option value="16">16</option>
                        <option value="18">18</option>
                        <option value="20">20</option>
                        <option value="22">22</option>
                        <option value="26">26</option>
                        <option value="28">28</option>
                        <option value="36">36</option>
                        <option value="48">48</option>
                        <option value="56">56</option>
                        <option value="72">72</option>
                    </select>
                </div>
                <div>
                    <span>线颜色：</span><input type="color" name="edgeStrokeCol" id="edgeStrokeCol">
                </div>
                <div>
                    <span>线宽：</span>
                    <select id="edgeStrokeWth">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                        <option>6</option>
                        <option>7</option>
                        <option>8</option>
                        <option>9</option>
                        <option>10</option>
                    </select>
                </div>
                <div>
                    <span>边框线样式：</span>
                    <select id="edgeSelectStrokeStyle">
                        <option value="0">实线</option>
                        <option value="1">虚线</option>
                    </select>
                </div>
                <div>
                    <span>箭头是否填充：</span>
                    <select id="edgeSelectFillArrow">
                        <option value="1">填充</option>
                        <option value="0">不填充</option>
                    </select>
                </div>
                <div>
                    <span>箭头大小：</span>
                    <select id="edgeSelectArrowSize">
                        <option value="0">0</option>
                        <option value="6">6</option>
                        <option value="13">13</option>
                        <option value="17">17</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="38">38</option>
                    </select>
                </div>
                <div>
                    <input id="edgeSubmit" type="button" value="确认">
                    <input id="edgeQuxiao" type="button" value="取消">
                </div>
            </form>
        </div>
    </div>
    <!-- 更改背景属性对话框 -->
    <div class="bgMode hide">
        <div>
            <form action="/cmdb/assets/" method="post" id="bgformId">
                <h2>更换背景</h2>
                <div>
                    <input name="xz" type="radio" value="image" checked/>
                    <div id="selImage">
                    <span>选择背景图片：</span>
                        <select id="bgChang">
                            <option value="../assets/images/grid.gif">默认</option>
                            <option value="../assets/bg/bg1.png">背景1</option>
                            <option value="../assets/bg/bg2.png">背景2</option>
                        </select>
                    </div>
                </div>
                <div>
                    <input name="xz" type="radio" value="color" />
                    <div id="selColor">
                        <span>选择背景颜色：</span><input type="color" name="wholebgcolor" id="wholebgcolor">
                    </div>
                </div>
                <div id="buts">
                    <input id="bgSubmit" type="button" value="确认">
                    <input id="bgquxiao" type="button" value="取消">
                </div>
            </form>
        </div>
    </div>
     <!-- 添加图标对话框 -->
     <div class="iconMode hide">
        <div>
            <form action="/cmdb/assets/" method="post" id="iconFormId">
                <h2>添加工具栏图标</h2>
                <p>
                    <label>请选择一个文件：</label>
                    <input type="file" id="iconFile"  onchange="readPicture()"/>
                </p>
                <div id="result"></div>
                <div id="buts">
                    <input id="iconSubmit" type="button" value="确认">
                    <input id="iconQuxiao" type="button" value="取消">
                </div>
            </form>
        </div>
    </div>
</body>  
</html>  

